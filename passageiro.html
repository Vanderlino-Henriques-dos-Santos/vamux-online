<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>√Årea do Passageiro - VAMUX</title>
        <link rel="stylesheet" href="css/index.css">
        <style>
            /* CSS para o mapa no passageiro.html - Garante que ele tenha tamanho */
            #map {
                width: 100%;
                height: 400px; /* Altura fixa para o mapa */
                border-radius: 10px;
                margin-top: 20px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
                background-color: #e0e0e0; /* Cor de fundo para ver o espa√ßo antes de carregar */
                display: block; /* Garante que o div esteja sempre vis√≠vel */
            }
        </style>
    </head>
    <body>
        <div class="container">
            <img src="assets/img/logo.jpg" alt="Logo VAMUX" class="logo">
            <h1 class="gradient-text">√Årea do Passageiro</h1>
            <div class="form-group">
                <label class="label-text" for="partida">Local de Partida</label>
                <input
                    type="text"
                    id="partida"
                    class="input-box"
                    placeholder="Ex.: Rua Felipe Camar√£o, 662 - Po√°-SP"
                >
            </div>
            <div class="form-group">
                <label class="label-text" for="destino">Destino</label>
                <input
                    type="text"
                    id="destino"
                    class="input-box"
                    placeholder="Ex.: Avenida Paulista, 1000 - S√£o Paulo-SP"
                >
            </div>
            <div class="button-group-inline">
                <button class="btn" onclick="calcularRota()">Calcular Corrida</button>
                <button class="btn" onclick="chamarCorrida()">Chamar Corrida</button>
            </div>
            <div id="map"></div> <p id="infoCorrida" class="gradient-text" style="margin-top: 15px;"></p>
            <p id="mensagemStatus" class="gradient-text"></p>
            <a href="index.html" class="link">Sair</a>
        </div>
        <script type="module" src="javascript/firebase-config.js"></script>
        <script type="module" src="javascript/passageiro.js"></script>

        <script>
            // Esta fun√ß√£o global ser√° chamada pela API do Google Maps quando ela terminar de carregar.
            // Ela atua como um "gatilho" para a inicializa√ß√£o do mapa que est√° em passageiro.js.
            function initMap() {
                console.log("üìç initMap (Passageiro) chamada! Google Maps API pronta.");
                // Chama a fun√ß√£o de inicializa√ß√£o real do mapa que est√° em passageiro.js.
                // Verificamos se ela existe antes de chamar, pois passageiro.js √© um m√≥dulo.
                if (typeof initPassengerMap === 'function') {
                    initPassengerMap();
                } else {
                    console.warn("‚ö†Ô∏è initPassengerMap n√£o encontrada em passageiro.js. Verifique se o script foi carregado corretamente.");
                }
            }

            // Esta fun√ß√£o carrega dinamicamente o script da API do Google Maps.
            function loadGoogleMapsScript() {
                // Verifica se a API j√° foi carregada. Isso √© um safeguard.
                if (typeof google === 'object' && typeof google.maps === 'object' && typeof google.maps.Map === 'function') {
                    initMap(); // Se j√° estiver carregada, inicializa o mapa diretamente
                    return;
                }
                const script = document.createElement('script');
                // ATEN√á√ÉO: SUBSTITUA PELA SUA CHAVE DE API COMPLETA DO GOOGLE MAPS
                script.src = "https://maps.googleapis.com/maps/api/js?key=AIzaSyD_gHvH6diRTaK0w68xdYfx5fPzNF23YXM&callback=initMap";
                script.async = true;
                script.defer = true;
                script.onerror = function() { // Captura erros de carregamento do script
                    console.error("‚ùå ERRO: O script do Google Maps falhou ao carregar em passageiro.html.");
                    document.getElementById('mensagemStatus').innerHTML = "‚ùå Erro ao carregar o mapa. Verifique a chave da API e sua conex√£o.";
                    document.getElementById('mensagemStatus').style.color = 'red';
                };
                document.head.appendChild(script); // Adiciona o script ao <head> da p√°gina
            }

            // Garante que o script do Google Maps seja carregado somente depois que o DOM estiver pronto.
            document.addEventListener('DOMContentLoaded', loadGoogleMapsScript);
        </script>
    </body>
</html>